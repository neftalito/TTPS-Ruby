<h1 class="text-2xl font-bold mb-6">Gestión de Usuarios</h1>

<div class="flex justify-end mb-4">
  <% if can? :create, User %>
    <%= link_to "Nuevo usuario",
                new_backstore_user_path,
                class: "px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md" %>
  <% end %>
</div>

<div class="overflow-x-auto shadow border border-gray-200 rounded-lg">
  <table class="min-w-full divide-y divide-gray-200 bg-white">
    <thead class="bg-gray-50">
    <tr>
      <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">ID</th>
      <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">Email</th>
      <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">Rol</th>
      <th class="px-6 py-3 text-right text-xs font-medium text-gray-700 uppercase tracking-wider">Acciones</th>
    </tr>
    </thead>

    <tbody class="divide-y divide-gray-200">
    <% @users.each do |user| %>
      <tr>
        <td class="px-6 py-4 whitespace-nowrap">
          <%= user.id %>
        </td>

        <td class="px-6 py-4 whitespace-nowrap">
          <%= user.email %>
        </td>

        <td class="px-6 py-4 whitespace-nowrap">
            <span class="px-2 py-1 rounded text-white
              <%= case user.role
                  when "admin" then "bg-red-600"
                  when "manager" then "bg-yellow-600"
                  else "bg-green-600"
                  end %>">
              <%= translated_role(user.role) %>
            </span>
        </td>

        <td class="px-6 py-4 whitespace-nowrap">
          <div class="flex justify-end items-center gap-3">
            <% if can? :update, user %>
              <%= link_to "Editar",
                          edit_backstore_user_path(user),
                          class: "px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded-md text-sm" %>
            <% end %>

            <% if can? :destroy, user %>
              <%= link_to "Eliminar",
                          backstore_user_path(user),
                          data: {
                            turbo_method: :delete,
                            turbo_confirm: "¿Seguro que querés eliminar este usuario?"
                          },
                          class: "px-3 py-1 bg-red-600 hover:bg-red-700 text-white rounded-md text-sm" %>
            <% end %>
          </div>
        </td>
      </tr>
    <% end %>
    </tbody>
  </table>
</div>
