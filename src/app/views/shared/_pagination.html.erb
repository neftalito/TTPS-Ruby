<% collection = local_assigns.fetch(:collection) %>
<% params_hash = local_assigns.fetch(:params, {}) %>
<% return if collection.blank? %>

<nav class="mt-8 flex w-full flex-col items-center gap-6 text-center md:flex-row md:items-center md:justify-between md:text-left" aria-label="Paginación">
  <div class="flex flex-col items-center gap-3 md:flex-row md:items-center md:gap-6 md:justify-start">
    <!-- Selector de por página -->
    <div class="flex items-center gap-2">
      <label for="per_page" class="text-sm text-proyecto-text whitespace-nowrap">Por página:</label>
      <%= form_with url: request.path, method: :get, local: true, class: "inline-block" do |f| %>
        <%= f.select :per_page,
                     options_for_select(
                       [[5, 5], [10, 10], [25, 25], [50, 50], [100, 100], ["Todos", "all"]],
                       params[:per_page] || 25
                     ),
                     {},
                     {
                       id: "per_page",
                       class: "px-3 py-1 text-sm border border-proyecto-secondary rounded-md bg-white text-proyecto-text focus:ring-2 focus:ring-proyecto-primary focus:border-proyecto-primary",
                       onchange: "this.form.submit()"
                     } %>

        <!-- Mantener los parámetros de filtros existentes -->
        <% params_hash.except(:page, :per_page).each do |key, value| %>
          <%= f.hidden_field key, value: value %>
        <% end %>
      <% end %>
    </div>
  </div>

  <div class="flex flex-col items-center gap-3 md:ml-auto md:flex-row md:items-center md:gap-6 md:justify-end md:text-right">
    <p class="text-sm text-proyecto-text md:leading-tight">
      Mostrando
      <span class="font-semibold text-proyecto-primary"><%= pagination_results_range(collection) %></span>
    </p>

    <% if collection.total_pages > 1 %>
      <div class="flex items-center justify-center gap-3 md:justify-end">
        <%= pagination_button("Anterior", collection.prev_page, collection, disabled: collection.prev_page.nil?) %>

        <span class="text-sm text-proyecto-text">
          Página
          <span class="font-semibold text-proyecto-primary"><%= collection.current_page %></span>
          de
          <span class="font-semibold text-proyecto-primary"><%= collection.total_pages %></span>
        </span>

        <%= pagination_button("Siguiente", collection.next_page, collection, disabled: collection.next_page.nil?) %>
      </div>
    <% end %>
  </div>
</nav>
